<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
  <head>
    <meta http-equiv="content-language" content="ru">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>ui-dev</title>

    <link rel="stylesheet" type="text/css" href="styles/ui.css">
    <link rel="stylesheet" type="text/css" href="styles/widgets/button.css">
    <link rel="stylesheet" type="text/css" href="styles/widgets/entry.css">
    <link rel="stylesheet" type="text/css" href="styles/elem/popup.css">

    <script type="text/javascript" src="src/jquery/jquery.js"></script>
<!--    <script type="text/javascript" src="src/jquery/rightClick.js"></script>
    <script type="text/javascript" src="src/jquery/corner.js"></script>-->

    <script type="text/javascript" src="src/builtin.js"></script>

    <script type="text/javascript" src="src/core/Core.js"></script>
    <script type="text/javascript" src="src/core/proto/UIObject.js"></script>
    <script type="text/javascript" src="src/core/proto/UIMovable.js"></script>
    <script type="text/javascript" src="src/core/proto/UIResizable.js"></script>
    <script type="text/javascript" src="src/core/proto/UIPopup.js"></script>
    <script type="text/javascript" src="src/core/IObject.js"></script>
    <script type="text/javascript" src="src/core/IEventProxy.js"></script>
    <script type="text/javascript" src="src/ui/intern/UIObject.js"></script>
    <script type="text/javascript" src="src/ui/intern/UIManager.js"></script>
    <script type="text/javascript" src="src/ui/intern/UIDragProvider.js"></script>
    <script type="text/javascript" src="src/ui/intern/UIMovable.js"></script>
    <script type="text/javascript" src="src/ui/intern/UIResizable.js"></script>
    <script type="text/javascript" src="src/ui/intern/UIPopup.js"></script>

    <script type="text/javascript" src="src/ui/widgets/UIWidget.js"></script>
    <script type="text/javascript" src="src/ui/widgets/UIButton.js"></script>
    <script type="text/javascript" src="src/ui/widgets/UIEntry.js"></script>
  </head>

  <body>
    <p>
      text text text text text text<br>
      text text text text text text<br>
      text text text text text text<br>
      text text text text text text
    </p>
    <div id="myDiv" style="position: relative; background: red; width: 100px; padding: 2px;">
      <div id="myDiv2" style="background: blue; cursor: pointer;">
        title
      </div>
      text text text text text text
      <div id="myDiv5" style="background: green; width: 10px; height: 10px; position: absolute; bottom: 0px; right: 0px; cursor: se-resize;"></div>
    </div>

    <div id="myDiv3" style="position: relative; background: green; width: 100px; padding: 2px;">
      <div id="myDiv4" style="background: blue; width: 100px; cursor: pointer;">
        title
      </div>
      text text text text text text
    </div>

    <div class="UIPopup" style="width: 120px;">
      <div id="popupSizer" class="UIPopupSizer"></div>
    </div>

    <div class="UIPopup" style="width: 100px;">
      text text text text text text
    </div>

    <script type="text/javascript">
      UI_MakeMovable ($('#myDiv')[0], {'moveArea': $('#myDiv2')[0]});
      UI_MakeMovable ($('#myDiv3')[0], {'moveArea': $('#myDiv4')[0]});

      UI_MakeResizable ($('#myDiv')[0], {'resizeArea': $('#myDiv5')[0]});
      UI_MakeResizable ($('.UIPopup')[0], {'resizeArea': $('#popupSizer')[0]});

      uiManager.registerContext ($('#myDiv')[0]);
      uiManager.registerContext ($('#myDiv3')[0]);
      uiManager.registerContext ($('.UIPopup')[0]);

      var cnt = $('.UIPopup')[0];
      var imgs = ['camera', null ]
      var buttons = [];
      for (var i =0; i < 2; ++i)
        {
          var img = imgs[i] ? ('pics/buttons/' + imgs[i] + '.gif') : null;
          buttons[i] = new UIButton ({'parent': cnt,
                                      'title': 'Нажми меня ' + (i + 1),
                                      'image': img
//                                      'click': function (e) { alert (e); }
                                      });
          cnt.appendChild (buttons[i].build ());
        }

      var simpleEntry = new UIEntry ({'parent': cnt});
      cnt.appendChild (simpleEntry.build ());

      var entry = new UIEntry ({'parent': cnt,
                                'text'  : 'Hi!',
                                'image' : 'pics/buttons/search.gif'});
      cnt.appendChild (entry.build ());

      buttons[0].onClick = function (btn, entries) { return function () {
            btn.setImage ('pics/buttons/config.gif');
            btn.setTitle ('Changed');

            entries[0].setSensitive (!entries[0].getSensitive ());
            entries[1].setSensitive (!entries[0].getSensitive ());

            entries[0].setFocus ();
          }
        } (buttons[1], [entry, simpleEntry]);

      buttons[1].onClick = function (e) { return function () {
            e.setText ('Hello, World!');
            e.setFocus ();
          }
        } (entry);

      entry.onChanged = function (btn) { return function (newText) {
            btn.setTitle (newText);
          }
        } (buttons[1]);

      uiManager.addHandler ('click', function (userData) {
           var e = userData['domEvent'];
           uiPopupManager.popup ($('.UIPopup')[1], {'x': e.pageX,
                                                    'y': e.pageY});
        }, {'affectContext': $('.UIPopup')[0]});

      uiManager.addHandler ('click', function (userData) {
          if (userData['context'] == document)
            {
              var e = userData['domEvent'];
              uiPopupManager.popup ($('.UIPopup')[0], {'x': e.pageX,
                                                       'y': e.pageY});
              userData['global']['focusTo'].setFocus ();
            }
        }, {'focusTo': buttons[0]});
    </script>
  </body>
</html>
